lwd = 2,
bty = "n")
# Your existing code to generate the log-likelihood grid
# ... (assuming beta1_likelihood_grid and beta1_hat are in your environment)
# ...
# 1. NORMALIZE THE LIKELIHOOD
# This creates a grid where the peak is 1
max_log_likelihood <- max(beta1_likelihood_grid)
normalized_likelihood_grid <- exp(beta1_likelihood_grid - max_log_likelihood)
# 2. PLOT THE NORMALIZED PROFILE
plot(beta1_grid, normalized_likelihood_grid,
type = "l",
col = "darkred",
lwd = 2,
xlab = expression(beta[1]),
ylab = "Normalized Likelihood",  # <-- Changed y-axis label
main = "Normalized Likelihood Profile for Beta1", # <-- Changed title
ylim = c(0, 1.05)) # Set y-axis limits from 0 to just above 1
# 3. ADD THE 95% CONFIDENCE INTERVAL CUTOFF LINE
# On the log-likelihood scale, the cutoff was max_ll - 1.92
# On the normalized likelihood scale, this becomes exp(-1.92)
cutoff_normalized <- exp(-qchisq(0.95, df = 1) / 2)
abline(h = cutoff_normalized, col = "green", lty = 2, lwd = 2)
# 4. ADD YOUR EXISTING VERTICAL LINES
abline(v = 1.591683, col = "blue", lty = 3, lwd = 2)
abline(v = 3.106073, col = "blue", lty = 3, lwd = 2)
abline(v = 1.68580, col = "red", lty = 3, lwd = 2)
abline(v = 3.219953, col = "red", lty = 3, lwd = 2)
abline(v = beta1_hat, col = 'black', lty = 1, lwd = 2) # Made MLE line solid
# 5. ADD A LEGEND
legend("topright",
legend = c("Normalized Likelihood", "MLE of Beta1", "95% CI Cutoff"),
col = c("darkred", "black", "green"),
lty = c(1, 1, 2),
lwd = 2,
bty = "n")
# Your existing code to generate the log-likelihood grid
# ... (assuming beta1_likelihood_grid and beta1_hat are in your environment)
# ...
# 1. NORMALIZE THE LIKELIHOOD
# This creates a grid where the peak is 1
max_log_likelihood <- max(beta1_likelihood_grid)
normalized_likelihood_grid <- exp(beta1_likelihood_grid)
# 2. PLOT THE NORMALIZED PROFILE
plot(beta1_grid, normalized_likelihood_grid,
type = "l",
col = "darkred",
lwd = 2,
xlab = expression(beta[1]),
ylab = "Normalized Likelihood",  # <-- Changed y-axis label
main = "Normalized Likelihood Profile for Beta1", # <-- Changed title
ylim = c(0, 1.05)) # Set y-axis limits from 0 to just above 1
# 3. ADD THE 95% CONFIDENCE INTERVAL CUTOFF LINE
# On the log-likelihood scale, the cutoff was max_ll - 1.92
# On the normalized likelihood scale, this becomes exp(-1.92)
cutoff_normalized <- exp(-qchisq(0.95, df = 1) / 2)
abline(h = cutoff_normalized, col = "green", lty = 2, lwd = 2)
# 4. ADD YOUR EXISTING VERTICAL LINES
abline(v = 1.591683, col = "blue", lty = 3, lwd = 2)
abline(v = 3.106073, col = "blue", lty = 3, lwd = 2)
abline(v = 1.68580, col = "red", lty = 3, lwd = 2)
abline(v = 3.219953, col = "red", lty = 3, lwd = 2)
abline(v = beta1_hat, col = 'black', lty = 1, lwd = 2) # Made MLE line solid
# 5. ADD A LEGEND
legend("topright",
legend = c("Normalized Likelihood", "MLE of Beta1", "95% CI Cutoff"),
col = c("darkred", "black", "green"),
lty = c(1, 1, 2),
lwd = 2,
bty = "n")
# Your existing code to generate the log-likelihood grid
# ... (assuming beta1_likelihood_grid and beta1_hat are in your environment)
# ...
# 1. NORMALIZE THE LIKELIHOOD
# This creates a grid where the peak is 1
max_log_likelihood <- max(beta1_likelihood_grid)
normalized_likelihood_grid <- exp(beta1_likelihood_grid - max_log_likelihood)
# 2. PLOT THE NORMALIZED PROFILE
plot(beta1_grid, normalized_likelihood_grid,
type = "l",
col = "darkred",
lwd = 2,
xlab = expression(beta[1]),
ylab = "Normalized Likelihood",  # <-- Changed y-axis label
main = "Normalized Likelihood Profile for Beta1", # <-- Changed title
ylim = c(0, 1.05)) # Set y-axis limits from 0 to just above 1
# 3. ADD THE 95% CONFIDENCE INTERVAL CUTOFF LINE
# On the log-likelihood scale, the cutoff was max_ll - 1.92
# On the normalized likelihood scale, this becomes exp(-1.92)
cutoff_normalized <- exp(-qchisq(0.95, df = 1) / 2)
abline(h = cutoff_normalized, col = "green", lty = 2, lwd = 2)
# 4. ADD YOUR EXISTING VERTICAL LINES
abline(v = 1.591683, col = "blue", lty = 3, lwd = 2)
abline(v = 3.106073, col = "blue", lty = 3, lwd = 2)
abline(v = 1.68580, col = "red", lty = 3, lwd = 2)
abline(v = 3.219953, col = "red", lty = 3, lwd = 2)
abline(v = beta1_hat, col = 'black', lty = 1, lwd = 2) # Made MLE line solid
# 5. ADD A LEGEND
legend("topright",
legend = c("Normalized Likelihood", "MLE of Beta1", "95% CI Cutoff"),
col = c("darkred", "black", "green"),
lty = c(1, 1, 2),
lwd = 2,
bty = "n")
# LOG LIKLIHOOD PROFILE
length <- 100
beta1_hat <- model$coefficients[2]
beta0_hat <- model$coefficients[1]
upper_beta1 = beta1_hat +  0.1
lower_beta1 = beta1_hat -  0.1
beta1_grid <- seq(lower_beta1 , upper_beta1,length.out = length)
beta1_likelihood_grid <- numeric(length)
for(i in seq_along(beta1_grid)) {
beta1 <- beta1_grid[i]
params <- c(beta0_hat,beta1)
beta1_likelihood_grid[i] <- -1 * neg_log_likelihood(params = params,
X = data$log_gdp,
y = data$high_lifeExp)
}
print(beta1_likelihood_grid)
plot(beta1_grid, beta1_likelihood_grid,
type = "l",                      # line plot
col = "darkred",                # line color
lwd = 2,                        # line width
xlab = expression(beta[1]),     # x-axis label with math notation
ylab = "Likelihood",            # y-axis label
main = "Likelihood vs Beta1")   # plot title
# Add a vertical dashed blue line at beta1 = 1.591683
abline(v = 1.591683, col = "blue", lty = 3, lwd = 2)
abline(v = 3.106073, col = "blue", lty = 3, lwd = 2)
abline(v =  1.68580, col = "red", lty = 3, lwd = 2)
abline(v = 3.219953, col = "red", lty = 3, lwd = 2)
abline(v = beta1_hat, col = 'black',lty = 3, lwd = 2)
max_log_likelihood <- max(beta1_likelihood_grid)
# Your existing code to generate the log-likelihood grid
# ... (assuming beta1_likelihood_grid and beta1_hat are in your environment)
# ...
# 1. NORMALIZE THE LIKELIHOOD
# This creates a grid where the peak is 1
max_log_likelihood <- max(beta1_likelihood_grid)
normalized_likelihood_grid <- exp(beta1_likelihood_grid - max_log_likelihood)
# 2. PLOT THE NORMALIZED PROFILE
plot(beta1_grid, normalized_likelihood_grid,
type = "l",
col = "darkred",
lwd = 2,
xlab = expression(beta[1]),
ylab = "Normalized Likelihood",  # <-- Changed y-axis label
main = "Normalized Likelihood Profile for Beta1", # <-- Changed title
ylim = c(0, 1.05)) # Set y-axis limits from 0 to just above 1
# 3. ADD THE 95% CONFIDENCE INTERVAL CUTOFF LINE
# On the log-likelihood scale, the cutoff was max_ll - 1.92
# On the normalized likelihood scale, this becomes exp(-1.92)
cutoff_normalized <- exp(-qchisq(0.95, df = 1) / 2)
abline(h = cutoff_normalized, col = "green", lty = 2, lwd = 2)
# 4. ADD YOUR EXISTING VERTICAL LINES
abline(v = 1.591683, col = "blue", lty = 3, lwd = 2)
abline(v = 3.106073, col = "blue", lty = 3, lwd = 2)
abline(v = 1.68580, col = "red", lty = 3, lwd = 2)
abline(v = 3.219953, col = "red", lty = 3, lwd = 2)
abline(v = beta1_hat, col = 'black', lty = 1, lwd = 2) # Made MLE line solid
# 5. ADD A LEGEND
legend("topright",
legend = c("Normalized Likelihood", "MLE of Beta1", "95% CI Cutoff"),
col = c("darkred", "black", "green"),
lty = c(1, 1, 2),
lwd = 2,
bty = "n")
# Your existing code to generate the log-likelihood grid
# ... (assuming beta1_likelihood_grid and beta1_hat are in your environment)
# ...
# 1. NORMALIZE THE LIKELIHOOD
# This creates a grid where the peak is 1
max_log_likelihood <- max(beta1_likelihood_grid)
normalized_likelihood_grid <- beta1_likelihood_grid - max_log_likelihood
# 2. PLOT THE NORMALIZED PROFILE
plot(beta1_grid, normalized_likelihood_grid,
type = "l",
col = "darkred",
lwd = 2,
xlab = expression(beta[1]),
ylab = "Normalized Likelihood",  # <-- Changed y-axis label
main = "Normalized Likelihood Profile for Beta1", # <-- Changed title
ylim = c(0, 1.05)) # Set y-axis limits from 0 to just above 1
# 3. ADD THE 95% CONFIDENCE INTERVAL CUTOFF LINE
# On the log-likelihood scale, the cutoff was max_ll - 1.92
# On the normalized likelihood scale, this becomes exp(-1.92)
cutoff_normalized <- exp(-qchisq(0.95, df = 1) / 2)
abline(h = cutoff_normalized, col = "green", lty = 2, lwd = 2)
# 4. ADD YOUR EXISTING VERTICAL LINES
abline(v = 1.591683, col = "blue", lty = 3, lwd = 2)
abline(v = 3.106073, col = "blue", lty = 3, lwd = 2)
abline(v = 1.68580, col = "red", lty = 3, lwd = 2)
abline(v = 3.219953, col = "red", lty = 3, lwd = 2)
abline(v = beta1_hat, col = 'black', lty = 1, lwd = 2) # Made MLE line solid
# 5. ADD A LEGEND
legend("topright",
legend = c("Normalized Likelihood", "MLE of Beta1", "95% CI Cutoff"),
col = c("darkred", "black", "green"),
lty = c(1, 1, 2),
lwd = 2,
bty = "n")
# Your existing code to generate the log-likelihood grid
# ... (assuming beta1_likelihood_grid and beta1_hat are in your environment)
# ...
# 1. NORMALIZE THE LIKELIHOOD
# This creates a grid where the peak is 1
max_log_likelihood <- max(beta1_likelihood_grid)
normalized_likelihood_grid <- beta1_likelihood_grid - max_log_likelihood
# 2. PLOT THE NORMALIZED PROFILE
plot(beta1_grid, normalized_likelihood_grid,
type = "l",
col = "darkred",
lwd = 2,
xlab = expression(beta[1]),
ylab = "Normalized Likelihood",  # <-- Changed y-axis label
main = "Normalized Likelihood Profile for Beta1", # <-- Changed title
# 3. ADD THE 95% CONFIDENCE INTERVAL CUTOFF LINE
# On the log-likelihood scale, the cutoff was max_ll - 1.92
# On the normalized likelihood scale, this becomes exp(-1.92)
cutoff_normalized <- exp(-qchisq(0.95, df = 1) / 2)
abline(h = cutoff_normalized, col = "green", lty = 2, lwd = 2)
# Your existing code to generate the log-likelihood grid
# ... (assuming beta1_likelihood_grid and beta1_hat are in your environment)
# ...
# 1. NORMALIZE THE LIKELIHOOD
# This creates a grid where the peak is 1
max_log_likelihood <- max(beta1_likelihood_grid)
normalized_likelihood_grid <- beta1_likelihood_grid - max_log_likelihood
# 2. PLOT THE NORMALIZED PROFILE
plot(beta1_grid, normalized_likelihood_grid,
type = "l",
col = "darkred",
lwd = 2,
xlab = expression(beta[1]),
ylab = "Normalized Likelihood",  # <-- Changed y-axis label
main = "Normalized Likelihood Profile for Beta1", # <-- Changed title
)
# 3. ADD THE 95% CONFIDENCE INTERVAL CUTOFF LINE
# On the log-likelihood scale, the cutoff was max_ll - 1.92
# On the normalized likelihood scale, this becomes exp(-1.92)
cutoff_normalized <- exp(-qchisq(0.95, df = 1) / 2)
abline(h = cutoff_normalized, col = "green", lty = 2, lwd = 2)
# 4. ADD YOUR EXISTING VERTICAL LINES
abline(v = 1.591683, col = "blue", lty = 3, lwd = 2)
abline(v = 3.106073, col = "blue", lty = 3, lwd = 2)
abline(v = 1.68580, col = "red", lty = 3, lwd = 2)
abline(v = 3.219953, col = "red", lty = 3, lwd = 2)
abline(v = beta1_hat, col = 'black', lty = 1, lwd = 2) # Made MLE line solid
# 5. ADD A LEGEND
legend("topright",
legend = c("Normalized Likelihood", "MLE of Beta1", "95% CI Cutoff"),
col = c("darkred", "black", "green"),
lty = c(1, 1, 2),
lwd = 2,
bty = "n")
# Your existing code to generate the log-likelihood grid
# ... (assuming beta1_likelihood_grid and beta1_hat are in your environment)
# ...
# 1. NORMALIZE THE LIKELIHOOD
# This creates a grid where the peak is 1
max_log_likelihood <- max(beta1_likelihood_grid)
normalized_likelihood_grid <- exp(beta1_likelihood_grid - max_log_likelihood)
# 2. PLOT THE NORMALIZED PROFILE
plot(beta1_grid, normalized_likelihood_grid,
type = "l",
col = "darkred",
lwd = 2,
xlab = expression(beta[1]),
ylab = "Normalized Likelihood",  # <-- Changed y-axis label
main = "Normalized Likelihood Profile for Beta1", # <-- Changed title
ylim = c(0, 1.05)) # Set y-axis limits from 0 to just above 1
# 3. ADD THE 95% CONFIDENCE INTERVAL CUTOFF LINE
# On the log-likelihood scale, the cutoff was max_ll - 1.92
# On the normalized likelihood scale, this becomes exp(-1.92)
cutoff_normalized <- exp(-qchisq(0.95, df = 1) / 2)
abline(h = cutoff_normalized, col = "green", lty = 2, lwd = 2)
# 4. ADD YOUR EXISTING VERTICAL LINES
abline(v = 1.591683, col = "blue", lty = 3, lwd = 2)
abline(v = 3.106073, col = "blue", lty = 3, lwd = 2)
abline(v = 1.68580, col = "red", lty = 3, lwd = 2)
abline(v = 3.219953, col = "red", lty = 3, lwd = 2)
abline(v = beta1_hat, col = 'black', lty = 1, lwd = 2) # Made MLE line solid
# 5. ADD A LEGEND
legend("topright",
legend = c("Normalized Likelihood", "MLE of Beta1", "95% CI Cutoff"),
col = c("darkred", "black", "green"),
lty = c(1, 1, 2),
lwd = 2,
bty = "n")
# LOG LIKLIHOOD PROFILE
length <- 100
beta1_hat <- model$coefficients[2]
beta0_hat <- model$coefficients[1]
upper_beta1 = beta1_hat +  1
lower_beta1 = beta1_hat -  2
beta1_grid <- seq(lower_beta1 , upper_beta1,length.out = length)
beta1_likelihood_grid <- numeric(length)
for(i in seq_along(beta1_grid)) {
beta1 <- beta1_grid[i]
params <- c(beta0_hat,beta1)
beta1_likelihood_grid[i] <- -1 * neg_log_likelihood(params = params,
X = data$log_gdp,
y = data$high_lifeExp)
}
print(beta1_likelihood_grid)
plot(beta1_grid, beta1_likelihood_grid,
type = "l",                      # line plot
col = "darkred",                # line color
lwd = 2,                        # line width
xlab = expression(beta[1]),     # x-axis label with math notation
ylab = "Likelihood",            # y-axis label
main = "Likelihood vs Beta1")   # plot title
# Add a vertical dashed blue line at beta1 = 1.591683
abline(v = 1.591683, col = "blue", lty = 3, lwd = 2)
abline(v = 3.106073, col = "blue", lty = 3, lwd = 2)
abline(v =  1.68580, col = "red", lty = 3, lwd = 2)
abline(v = 3.219953, col = "red", lty = 3, lwd = 2)
abline(v = beta1_hat, col = 'black',lty = 3, lwd = 2)
max_log_likelihood <- max(beta1_likelihood_grid)
# LOG LIKLIHOOD PROFILE
length <- 100
beta1_hat <- model$coefficients[2]
beta0_hat <- model$coefficients[1]
upper_beta1 = beta1_hat +  1
lower_beta1 = beta1_hat -  1
beta1_grid <- seq(lower_beta1 , upper_beta1,length.out = length)
beta1_likelihood_grid <- numeric(length)
for(i in seq_along(beta1_grid)) {
beta1 <- beta1_grid[i]
params <- c(beta0_hat,beta1)
beta1_likelihood_grid[i] <- -1 * neg_log_likelihood(params = params,
X = data$log_gdp,
y = data$high_lifeExp)
}
print(beta1_likelihood_grid)
plot(beta1_grid, beta1_likelihood_grid,
type = "l",                      # line plot
col = "darkred",                # line color
lwd = 2,                        # line width
xlab = expression(beta[1]),     # x-axis label with math notation
ylab = "Likelihood",            # y-axis label
main = "Likelihood vs Beta1")   # plot title
# Add a vertical dashed blue line at beta1 = 1.591683
abline(v = 1.591683, col = "blue", lty = 3, lwd = 2)
abline(v = 3.106073, col = "blue", lty = 3, lwd = 2)
abline(v =  1.68580, col = "red", lty = 3, lwd = 2)
abline(v = 3.219953, col = "red", lty = 3, lwd = 2)
abline(v = beta1_hat, col = 'black',lty = 3, lwd = 2)
max_log_likelihood <- max(beta1_likelihood_grid)
# Your existing code to generate the log-likelihood grid
# ... (assuming beta1_likelihood_grid and beta1_hat are in your environment)
# ...
# 1. NORMALIZE THE LIKELIHOOD
# This creates a grid where the peak is 1
max_log_likelihood <- max(beta1_likelihood_grid)
normalized_likelihood_grid <- exp(beta1_likelihood_grid - max_log_likelihood)
# 2. PLOT THE NORMALIZED PROFILE
plot(beta1_grid, normalized_likelihood_grid,
type = "l",
col = "darkred",
lwd = 2,
xlab = expression(beta[1]),
ylab = "Normalized Likelihood",  # <-- Changed y-axis label
main = "Normalized Likelihood Profile for Beta1", # <-- Changed title
ylim = c(0, 1.05)) # Set y-axis limits from 0 to just above 1
# 3. ADD THE 95% CONFIDENCE INTERVAL CUTOFF LINE
# On the log-likelihood scale, the cutoff was max_ll - 1.92
# On the normalized likelihood scale, this becomes exp(-1.92)
cutoff_normalized <- exp(-qchisq(0.95, df = 1) / 2)
abline(h = cutoff_normalized, col = "green", lty = 2, lwd = 2)
# 4. ADD YOUR EXISTING VERTICAL LINES
abline(v = 1.591683, col = "blue", lty = 3, lwd = 2)
abline(v = 3.106073, col = "blue", lty = 3, lwd = 2)
abline(v = 1.68580, col = "red", lty = 3, lwd = 2)
abline(v = 3.219953, col = "red", lty = 3, lwd = 2)
abline(v = beta1_hat, col = 'black', lty = 1, lwd = 2) # Made MLE line solid
# 5. ADD A LEGEND
legend("topright",
legend = c("Normalized Likelihood", "MLE of Beta1", "95% CI Cutoff"),
col = c("darkred", "black", "green"),
lty = c(1, 1, 2),
lwd = 2,
bty = "n")
# LOG LIKLIHOOD PROFILE
length <- 100
beta1_hat <- model$coefficients[2]
beta0_hat <- model$coefficients[1]
upper_beta1 = beta1_hat +  0.1
lower_beta1 = beta1_hat -  0.1
beta1_grid <- seq(lower_beta1 , upper_beta1,length.out = length)
beta1_likelihood_grid <- numeric(length)
for(i in seq_along(beta1_grid)) {
beta1 <- beta1_grid[i]
params <- c(beta0_hat,beta1)
beta1_likelihood_grid[i] <- -1 * neg_log_likelihood(params = params,
X = data$log_gdp,
y = data$high_lifeExp)
}
print(beta1_likelihood_grid)
plot(beta1_grid, beta1_likelihood_grid,
type = "l",                      # line plot
col = "darkred",                # line color
lwd = 2,                        # line width
xlab = expression(beta[1]),     # x-axis label with math notation
ylab = "Likelihood",            # y-axis label
main = "Likelihood vs Beta1")   # plot title
# Add a vertical dashed blue line at beta1 = 1.591683
abline(v = 1.591683, col = "blue", lty = 3, lwd = 2)
abline(v = 3.106073, col = "blue", lty = 3, lwd = 2)
abline(v =  1.68580, col = "red", lty = 3, lwd = 2)
abline(v = 3.219953, col = "red", lty = 3, lwd = 2)
abline(v = beta1_hat, col = 'black',lty = 3, lwd = 2)
max_log_likelihood <- max(beta1_likelihood_grid)
# Your existing code to generate the log-likelihood grid
# ... (assuming beta1_likelihood_grid and beta1_hat are in your environment)
# ...
# 1. NORMALIZE THE LIKELIHOOD
# This creates a grid where the peak is 1
max_log_likelihood <- max(beta1_likelihood_grid)
normalized_likelihood_grid <- exp(beta1_likelihood_grid - max_log_likelihood)
# 2. PLOT THE NORMALIZED PROFILE
plot(beta1_grid, normalized_likelihood_grid,
type = "l",
col = "darkred",
lwd = 2,
xlab = expression(beta[1]),
ylab = "Normalized Likelihood",  # <-- Changed y-axis label
main = "Normalized Likelihood Profile for Beta1", # <-- Changed title
ylim = c(0, 1.05)) # Set y-axis limits from 0 to just above 1
# 3. ADD THE 95% CONFIDENCE INTERVAL CUTOFF LINE
# On the log-likelihood scale, the cutoff was max_ll - 1.92
# On the normalized likelihood scale, this becomes exp(-1.92)
cutoff_normalized <- exp(-qchisq(0.95, df = 1) / 2)
abline(h = cutoff_normalized, col = "green", lty = 2, lwd = 2)
# 4. ADD YOUR EXISTING VERTICAL LINES
abline(v = 1.591683, col = "blue", lty = 3, lwd = 2)
abline(v = 3.106073, col = "blue", lty = 3, lwd = 2)
abline(v = 1.68580, col = "red", lty = 3, lwd = 2)
abline(v = 3.219953, col = "red", lty = 3, lwd = 2)
abline(v = beta1_hat, col = 'black', lty = 1, lwd = 2) # Made MLE line solid
# 5. ADD A LEGEND
legend("topright",
legend = c("Normalized Likelihood", "MLE of Beta1", "95% CI Cutoff"),
col = c("darkred", "black", "green"),
lty = c(1, 1, 2),
lwd = 2,
bty = "n")
# LOG LIKLIHOOD PROFILE
length <- 200
beta1_hat <- model$coefficients[2]
beta0_hat <- model$coefficients[1]
upper_beta1 = beta1_hat +  0.1
lower_beta1 = beta1_hat -  0.1
beta1_grid <- seq(lower_beta1 , upper_beta1,length.out = length)
beta1_likelihood_grid <- numeric(length)
for(i in seq_along(beta1_grid)) {
beta1 <- beta1_grid[i]
params <- c(beta0_hat,beta1)
beta1_likelihood_grid[i] <- -1 * neg_log_likelihood(params = params,
X = data$log_gdp,
y = data$high_lifeExp)
}
print(beta1_likelihood_grid)
plot(beta1_grid, beta1_likelihood_grid,
type = "l",                      # line plot
col = "darkred",                # line color
lwd = 2,                        # line width
xlab = expression(beta[1]),     # x-axis label with math notation
ylab = "Likelihood",            # y-axis label
main = "Likelihood vs Beta1")   # plot title
# Add a vertical dashed blue line at beta1 = 1.591683
abline(v = 1.591683, col = "blue", lty = 3, lwd = 2)
abline(v = 3.106073, col = "blue", lty = 3, lwd = 2)
abline(v =  1.68580, col = "red", lty = 3, lwd = 2)
abline(v = 3.219953, col = "red", lty = 3, lwd = 2)
abline(v = beta1_hat, col = 'black',lty = 3, lwd = 2)
max_log_likelihood <- max(beta1_likelihood_grid)
# Your existing code to generate the log-likelihood grid
# ... (assuming beta1_likelihood_grid and beta1_hat are in your environment)
# ...
# 1. NORMALIZE THE LIKELIHOOD
# This creates a grid where the peak is 1
max_log_likelihood <- max(beta1_likelihood_grid)
normalized_likelihood_grid <- exp(beta1_likelihood_grid - max_log_likelihood)
# 2. PLOT THE NORMALIZED PROFILE
plot(beta1_grid, normalized_likelihood_grid,
type = "l",
col = "darkred",
lwd = 2,
xlab = expression(beta[1]),
ylab = "Normalized Likelihood",  # <-- Changed y-axis label
main = "Normalized Likelihood Profile for Beta1", # <-- Changed title
ylim = c(0, 1.05)) # Set y-axis limits from 0 to just above 1
# 3. ADD THE 95% CONFIDENCE INTERVAL CUTOFF LINE
# On the log-likelihood scale, the cutoff was max_ll - 1.92
# On the normalized likelihood scale, this becomes exp(-1.92)
cutoff_normalized <- exp(-qchisq(0.95, df = 1) / 2)
abline(h = cutoff_normalized, col = "green", lty = 2, lwd = 2)
# 4. ADD YOUR EXISTING VERTICAL LINES
abline(v = 1.591683, col = "blue", lty = 3, lwd = 2)
abline(v = 3.106073, col = "blue", lty = 3, lwd = 2)
abline(v = 1.68580, col = "red", lty = 3, lwd = 2)
abline(v = 3.219953, col = "red", lty = 3, lwd = 2)
abline(v = beta1_hat, col = 'black', lty = 1, lwd = 2) # Made MLE line solid
# 5. ADD A LEGEND
legend("topright",
legend = c("Normalized Likelihood", "MLE of Beta1", "95% CI Cutoff"),
col = c("darkred", "black", "green"),
lty = c(1, 1, 2),
lwd = 2,
bty = "n")
